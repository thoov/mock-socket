!function e(t,n,r){function s(o,l){if(!n[o]){if(!t[o]){var c="function"==typeof require&&require;if(!l&&c)return c(o,!0);if(i)return i(o,!0);var a=new Error("Cannot find module '"+o+"'");throw a.code="MODULE_NOT_FOUND",a}var u=n[o]={exports:{}};t[o][0].call(u.exports,function(e){var n=t[o][1][e];return s(n?n:e)},u,u.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(e,t,n){var r=e("./service"),s=e("./mock-server"),i=e("./mock-socket"),o=e("./mock-socket-io"),l=e("./helpers/global-context");l.SocketService=r,l.MockSocket=i,l.MockSocketIO=o,l.MockServer=s},{"./helpers/global-context":3,"./mock-server":7,"./mock-socket":9,"./mock-socket-io":8,"./service":10}],2:[function(e,t,n){function r(e,t){s.setTimeout(function(t){e.call(t)},4,t)}var s=e("./global-context");t.exports=r},{"./global-context":3}],3:[function(e,t,n){(function(e){var n;if(n="undefined"==typeof window?e:window,!n)throw new Error("Unable to set the global context to either window or global.");t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(e,t,n){function r(e,t,n){var r=null,s=null,i=!1,o=!1,l="",c=null;try{var a=new MessageEvent(e);a.initMessageEvent(e,i,o,t,n,l),Object.defineProperties(a,{target:{get:function(){return c},set:function(e){c=e}},srcElement:{get:function(){return this.target}},currentTarget:{get:function(){return this.target}}})}catch(u){var a={type:e,bubbles:i,cancelable:o,data:t,origin:n,lastEventId:l,source:s,ports:r,defaultPrevented:!1,returnValue:!0,clipboardData:void 0};Object.defineProperties(a,{target:{get:function(){return c},set:function(e){c=e}},srcElement:{get:function(){return this.target}},currentTarget:{get:function(){return this.target}}})}return a}t.exports=r},{}],5:[function(e,t,n){function r(e){var t=i("path",e),n=i("?",e);return n=n?"?"+n:"",""===t?e.split("?")[0]+"/"+n:e}function s(e){return!isNaN(parseFloat(e))&&isFinite(e)}function i(e,t){var n=t||window.location.toString();if(!e)return n;e=e.toString(),"//"===n.substring(0,2)?n="http:"+n:1===n.split("://").length&&(n="http://"+n),t=n.split("/");var r={auth:""},i=t[2].split("@");1===i.length?i=i[0].split(":"):(r.auth=i[0],i=i[1].split(":")),r.protocol=t[0],r.hostname=i[0],r.port=i[1]||("https"===r.protocol.split(":")[0].toLowerCase()?"443":"80"),r.pathname=(t.length>3?"/":"")+t.slice(3,t.length).join("/").split("?")[0].split("#")[0];var o=r.pathname;"/"===o.charAt(o.length-1)&&(o=o.substring(0,o.length-1));var l=r.hostname,c=l.split("."),a=o.split("/");if("hostname"===e)return l;if("domain"===e)return/^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$/.test(l)?l:c.slice(-2).join(".");if("sub"===e)return c.slice(0,c.length-2).join(".");if("port"===e)return r.port;if("protocol"===e)return r.protocol.split(":")[0];if("auth"===e)return r.auth;if("user"===e)return r.auth.split(":")[0];if("pass"===e)return r.auth.split(":")[1]||"";if("path"===e)return r.pathname;if("."===e.charAt(0)){if(e=e.substring(1),s(e))return e=parseInt(e,10),c[0>e?c.length+e:e-1]||""}else{if(s(e))return e=parseInt(e,10),a[0>e?a.length+e:e]||"";if("file"===e)return a.slice(-1)[0];if("filename"===e)return a.slice(-1)[0].split(".")[0];if("fileext"===e)return a.slice(-1)[0].split(".")[1]||"";if("?"===e.charAt(0)||"#"===e.charAt(0)){var u=n,h=null;if("?"===e.charAt(0)?u=(u.split("?")[1]||"").split("#")[0]:"#"===e.charAt(0)&&(u=u.split("#")[1]||""),!e.charAt(1))return u;e=e.substring(1),u=u.split("&");for(var f=0,p=u.length;p>f;f++)if(h=u[f].split("="),h[0]===e)return h[1]||"";return null}}return""}t.exports=r},{}],6:[function(e,t,n){function r(e){var t=function(t){return function(n){n.target=e,t.apply(e,arguments)}};Object.defineProperties(e,{onopen:{enumerable:!0,get:function(){return this._onopen},set:function(n){this._onopen=t(n),this.service.setCallbackObserver("clientOnOpen",this._onopen,e)}},onmessage:{enumerable:!0,get:function(){return this._onmessage},set:function(n){this._onmessage=t(n),this.service.setCallbackObserver("clientOnMessage",this._onmessage,e)}},onclose:{enumerable:!0,get:function(){return this._onclose},set:function(n){this._onclose=t(n),this.service.setCallbackObserver("clientOnclose",this._onclose,e)}},onerror:{enumerable:!0,get:function(){return this._onerror},set:function(n){this._onerror=t(n),this.service.setCallbackObserver("clientOnError",this._onerror,e)}}})}t.exports=r},{}],7:[function(e,t,n){function r(e){var t=new s;this.url=o(e),c.MockSocket.services[this.url]=t,this.service=t,t.server=this,this.rooms={}}var s=e("./service"),i=e("./helpers/delay"),o=e("./helpers/url-transform"),l=e("./helpers/message-event"),c=e("./helpers/global-context");r.of=function(e){return new r(e)},r.prototype={service:null,on:function(e,t){var n;if("function"!=typeof t||"string"!=typeof e)return!1;switch(e){case"connection":n="clientHasJoined";break;case"message":n="clientHasSentMessage";break;case"close":n="clientHasLeft";break;default:n=e}"string"==typeof n&&(this.service.clearAll(n),this.service.setCallbackObserver(n,t,this))},send:function(e){this.emit("message",e)},emit:function(e,t){i(function(){this.service.sendMessageToClients(l(e,t,this.url))},this)},close:function(){i(function(){this.service.closeConnectionFromServer(l("close",null,this.url))},this)},join:function(e){this.rooms[e]=!0},leave:function(e){delete this.rooms[e]},to:function(e){return null!==this.rooms[e]?this:{emit:function(){}}}},t.exports=r},{"./helpers/delay":2,"./helpers/global-context":3,"./helpers/message-event":4,"./helpers/url-transform":5,"./service":10}],8:[function(e,t,n){function r(e){var t=new s(e);return t._isSocketIO=!0,t}var s=e("./mock-socket");r.connect=function(e){return r(e)},t.exports=r},{"./mock-socket":9}],9:[function(e,t,n){function r(e){this.binaryType="blob",this.url=i(e),this.readyState=l.MockSocket.CONNECTING,this.service=l.MockSocket.services[this.url],c(this),s(function(){this.service.clientIsConnecting(this,this._updateReadyState)},this)}var s=e("./helpers/delay"),i=e("./helpers/url-transform"),o=e("./helpers/message-event"),l=e("./helpers/global-context"),c=e("./helpers/websocket-properties");r.connect=function(e){return new r(e)},r.CONNECTING=0,r.OPEN=1,r.CLOSING=2,r.LOADING=3,r.CLOSED=4,r.services={},r.prototype={_onopen:null,_onmessage:null,_onerror:null,_onclose:null,_isSocketIO:null,on:function(e,t){var n=this._isSocketIO,r=function(r){if(r.type===e)if(r.target=this,n){var s=arguments[0].data;t.apply(this,[s])}else t.apply(this,arguments)};this.service.setCallbackObserver("clientOnMessage",r,this)},service:null,_eventHandlers:{},addEventListener:function(e,t){if(!this._eventHandlers[e]){this._eventHandlers[e]=[];var n=this;this["on"+e]=function(e){n.dispatchEvent(e)}}this._eventHandlers[e].push(t)},removeEventListener:function(e,t){if(this._eventHandlers[e]){var n=this._eventHandlers[e];n.splice(n.indexOf(t),1),n.length||(delete this._eventHandlers[e],delete this["on"+e])}},dispatchEvent:function(e){var t=this._eventHandlers[e.type];if(t)for(var n=0;n<t.length;n++)t[n].call(this,e)},send:function(e){this.emit("message",e)},emit:function(e,t){s(function(){this.service.sendMessageToServer(o(e,t,this.url))},this)},close:function(){s(function(){this.service.closeConnectionFromClient(o("close",null,this.url),this)},this)},_updateReadyState:function(e){e>=0&&4>=e&&(this.readyState=e)}},t.exports=r},{"./helpers/delay":2,"./helpers/global-context":3,"./helpers/message-event":4,"./helpers/url-transform":5,"./helpers/websocket-properties":6}],10:[function(e,t,n){function r(){this.list={}}var s=e("./helpers/message-event"),i=e("./helpers/global-context");r.prototype={server:null,clientIsConnecting:function(e,t){return this.observe("updateReadyState",t,e),this.server?(this.notifyOnlyFor(e,"updateReadyState",i.MockSocket.OPEN),this.notify("clientHasJoined",this.server),void this.notifyOnlyFor(e,"clientOnOpen",s("open",null,this.server.url))):(this.notify(e,"updateReadyState",i.MockSocket.CLOSED),this.notifyOnlyFor(e,"clientOnError"),!1)},closeConnectionFromServer:function(e){this.notify("updateReadyState",i.MockSocket.CLOSING),this.notify("clientOnclose",e),this.notify("updateReadyState",i.MockSocket.CLOSED),this.notify("clientHasLeft")},closeConnectionFromClient:function(e,t){t.readyState===i.MockSocket.OPEN&&(this.notifyOnlyFor(t,"updateReadyState",i.MockSocket.CLOSING),this.notifyOnlyFor(t,"clientOnclose",e),this.notifyOnlyFor(t,"updateReadyState",i.MockSocket.CLOSED),this.notify("clientHasLeft"))},sendMessageToServer:function(e){var t=e.type,n="clientHasSentMessage";t&&"message"!==t&&(n=t),this.notify(n,e.data,e)},sendMessageToClients:function(e){this.notify("clientOnMessage",e)},setCallbackObserver:function(e,t,n){this.observe(e,t,n)},observe:function(e,t,n){return"string"!=typeof e||"function"!=typeof t||n&&"object"!=typeof n?!1:(this.list[e]||(this.list[e]=[]),void this.list[e].push({callback:t,context:n}))},clearAll:function(e){return this.verifyNamespaceArg(e)?void(this.list[e]=[]):!1},notify:function(e){var t=Array.prototype.slice.call(arguments,1);if(!this.verifyNamespaceArg(e))return!1;for(var n=0,r=this.list[e].length;r>n;n++)this.list[e][n].callback.apply(this.list[e][n].context,t)},notifyOnlyFor:function(e,t){var n=Array.prototype.slice.call(arguments,2);if(!this.verifyNamespaceArg(t))return!1;for(var r=0,s=this.list[t].length;s>r;r++)this.list[t][r].context===e&&this.list[t][r].callback.apply(this.list[t][r].context,n)},verifyNamespaceArg:function(e){return"string"==typeof e&&this.list[e]?!0:!1}},t.exports=r},{"./helpers/global-context":3,"./helpers/message-event":4}]},{},[1]);