(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var _globalContext=require("./global-context");var _globalContext2=_interopRequireDefault(_globalContext);function delay(callback,context){_globalContext2["default"].setTimeout(function(context){callback.call(context)},4,context)}exports["default"]=delay;module.exports=exports["default"]},{"./global-context":2}],2:[function(require,module,exports){(function(global){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var globalContext;if(typeof window==="undefined"){globalContext=global}else{globalContext=window}if(!globalContext){throw new Error("Unable to set the global context to either window or global.")}exports["default"]=globalContext;module.exports=exports["default"]}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],3:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function socketEventMessage(name,data,origin){var ports=null;var source=null;var bubbles=false;var cancelable=false;var lastEventId="";var targetPlacehold=null;var messageEvent;try{messageEvent=new MessageEvent(name);messageEvent.initMessageEvent(name,bubbles,cancelable,data,origin,lastEventId);Object.defineProperties(messageEvent,{target:{get:function get(){return targetPlacehold},set:function set(value){targetPlacehold=value}},srcElement:{get:function get(){return this.target}},currentTarget:{get:function get(){return this.target}}})}catch(e){messageEvent={type:name,bubbles:bubbles,cancelable:cancelable,data:data,origin:origin,lastEventId:lastEventId,source:source,ports:ports,defaultPrevented:false,returnValue:true,clipboardData:undefined};Object.defineProperties(messageEvent,{target:{get:function get(){return targetPlacehold},set:function set(value){targetPlacehold=value}},srcElement:{get:function get(){return this.target}},currentTarget:{get:function get(){return this.target}}})}return messageEvent}exports["default"]=socketEventMessage;module.exports=exports["default"]},{}],4:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function urlTransform(url){var urlPath=urlParse("path",url);var urlQuery=urlParse("?",url);urlQuery=urlQuery?"?"+urlQuery:"";if(urlPath===""){return url.split("?")[0]+"/"+urlQuery}return url}function isNumeric(arg){return!isNaN(parseFloat(arg))&&isFinite(arg)}function urlParse(arg,url){var _ls=url||window.location.toString();if(!arg){return _ls}else{arg=arg.toString()}if(_ls.substring(0,2)==="//"){_ls="http:"+_ls}else if(_ls.split("://").length===1){_ls="http://"+_ls}url=_ls.split("/");var _l={auth:""},host=url[2].split("@");if(host.length===1){host=host[0].split(":")}else{_l.auth=host[0];host=host[1].split(":")}_l.protocol=url[0];_l.hostname=host[0];_l.port=host[1]||(_l.protocol.split(":")[0].toLowerCase()==="https"?"443":"80");_l.pathname=(url.length>3?"/":"")+url.slice(3,url.length).join("/").split("?")[0].split("#")[0];var _p=_l.pathname;if(_p.charAt(_p.length-1)==="/"){_p=_p.substring(0,_p.length-1)}var _h=_l.hostname,_hs=_h.split("."),_ps=_p.split("/");if(arg==="hostname"){return _h}else if(arg==="domain"){if(/^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$/.test(_h)){return _h}return _hs.slice(-2).join(".")}else if(arg==="sub"){return _hs.slice(0,_hs.length-2).join(".")}else if(arg==="port"){return _l.port}else if(arg==="protocol"){return _l.protocol.split(":")[0]}else if(arg==="auth"){return _l.auth}else if(arg==="user"){return _l.auth.split(":")[0]}else if(arg==="pass"){return _l.auth.split(":")[1]||""}else if(arg==="path"){return _l.pathname}else if(arg.charAt(0)==="."){arg=arg.substring(1);if(isNumeric(arg)){arg=parseInt(arg,10);return _hs[arg<0?_hs.length+arg:arg-1]||""}}else if(isNumeric(arg)){arg=parseInt(arg,10);return _ps[arg<0?_ps.length+arg:arg]||""}else if(arg==="file"){return _ps.slice(-1)[0]}else if(arg==="filename"){return _ps.slice(-1)[0].split(".")[0]}else if(arg==="fileext"){return _ps.slice(-1)[0].split(".")[1]||""}else if(arg.charAt(0)==="?"||arg.charAt(0)==="#"){var params=_ls,param=null;if(arg.charAt(0)==="?"){params=(params.split("?")[1]||"").split("#")[0]}else if(arg.charAt(0)==="#"){params=params.split("#")[1]||""}if(!arg.charAt(1)){return params}arg=arg.substring(1);params=params.split("&");for(var i=0,ii=params.length;i<ii;i++){param=params[i].split("=");if(param[0]===arg){return param[1]||""}}return null}return""}exports["default"]=urlTransform;module.exports=exports["default"]},{}],5:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function webSocketProperties(websocket){var eventMessageSource=function eventMessageSource(callback){return function(event){event.target=websocket;callback.apply(websocket,arguments)}};Object.defineProperties(websocket,{onopen:{enumerable:true,get:function get(){return this._onopen},set:function set(callback){this._onopen=eventMessageSource(callback);this.service.setCallbackObserver("clientOnOpen",this._onopen,websocket)}},onmessage:{enumerable:true,get:function get(){return this._onmessage},set:function set(callback){this._onmessage=eventMessageSource(callback);this.service.setCallbackObserver("clientOnMessage",this._onmessage,websocket)}},onclose:{enumerable:true,get:function get(){return this._onclose},set:function set(callback){this._onclose=eventMessageSource(callback);this.service.setCallbackObserver("clientOnclose",this._onclose,websocket)}},onerror:{enumerable:true,get:function get(){return this._onerror},set:function set(callback){this._onerror=eventMessageSource(callback);this.service.setCallbackObserver("clientOnError",this._onerror,websocket)}}})}exports["default"]=webSocketProperties;module.exports=exports["default"]},{}],6:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var _service=require("./service");var _service2=_interopRequireDefault(_service);var _mockServer=require("./mock-server");var _mockServer2=_interopRequireDefault(_mockServer);var _mockSocket=require("./mock-socket");var _mockSocket2=_interopRequireDefault(_mockSocket);var _helpersGlobalContext=require("./helpers/global-context");var _helpersGlobalContext2=_interopRequireDefault(_helpersGlobalContext);_helpersGlobalContext2["default"].SocketService=_service2["default"];_helpersGlobalContext2["default"].MockSocket=_mockSocket2["default"];_helpersGlobalContext2["default"].MockServer=_mockServer2["default"]},{"./helpers/global-context":2,"./mock-server":7,"./mock-socket":8,"./service":9}],7:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var _service=require("./service");var _service2=_interopRequireDefault(_service);var _helpersDelay=require("./helpers/delay");var _helpersDelay2=_interopRequireDefault(_helpersDelay);var _helpersUrlTransform=require("./helpers/url-transform");var _helpersUrlTransform2=_interopRequireDefault(_helpersUrlTransform);var _helpersMessageEvent=require("./helpers/message-event");var _helpersMessageEvent2=_interopRequireDefault(_helpersMessageEvent);var _helpersGlobalContext=require("./helpers/global-context");var _helpersGlobalContext2=_interopRequireDefault(_helpersGlobalContext);function MockServer(url){var service=new _service2["default"];this.url=(0,_helpersUrlTransform2["default"])(url);_helpersGlobalContext2["default"].MockSocket.services[this.url]=service;this.service=service;if(url.indexOf(MockServer.unresolvableURL)===-1){service.server=this}}MockServer.unresolvableURL="ws://unresolvable_url";MockServer.prototype={service:null,on:function on(type,callback){var observerKey;if(typeof callback!=="function"||typeof type!=="string"){return false}switch(type){case"connection":observerKey="clientHasJoined";break;case"message":observerKey="clientHasSentMessage";break;case"close":observerKey="clientHasLeft";break}if(typeof observerKey==="string"){this.service.clearAll(observerKey);this.service.setCallbackObserver(observerKey,callback,this)}},send:function send(data){(0,_helpersDelay2["default"])(function(){this.service.sendMessageToClients((0,_helpersMessageEvent2["default"])("message",data,this.url))},this)},close:function close(){(0,_helpersDelay2["default"])(function(){this.service.closeConnectionFromServer((0,_helpersMessageEvent2["default"])("close",null,this.url))},this)}};exports["default"]=MockServer;module.exports=exports["default"]},{"./helpers/delay":1,"./helpers/global-context":2,"./helpers/message-event":3,"./helpers/url-transform":4,"./service":9}],8:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var _helpersDelay=require("./helpers/delay");var _helpersDelay2=_interopRequireDefault(_helpersDelay);var _helpersUrlTransform=require("./helpers/url-transform");var _helpersUrlTransform2=_interopRequireDefault(_helpersUrlTransform);var _helpersMessageEvent=require("./helpers/message-event");var _helpersMessageEvent2=_interopRequireDefault(_helpersMessageEvent);var _helpersGlobalContext=require("./helpers/global-context");var _helpersGlobalContext2=_interopRequireDefault(_helpersGlobalContext);var _helpersWebsocketProperties=require("./helpers/websocket-properties");var _helpersWebsocketProperties2=_interopRequireDefault(_helpersWebsocketProperties);function MockSocket(url){this.binaryType="blob";this.url=(0,_helpersUrlTransform2["default"])(url);this.readyState=_helpersGlobalContext2["default"].MockSocket.CONNECTING;this.service=_helpersGlobalContext2["default"].MockSocket.services[this.url];this._eventHandlers={};(0,_helpersWebsocketProperties2["default"])(this);(0,_helpersDelay2["default"])(function(){this.service.clientIsConnecting(this,this._updateReadyState)},this)}MockSocket.CONNECTING=0;MockSocket.OPEN=1;MockSocket.CLOSING=2;MockSocket.CLOSED=3;MockSocket.services={};MockSocket.prototype={_onopen:null,_onmessage:null,_onerror:null,_onclose:null,service:null,_eventHandlers:{},addEventListener:function addEventListener(event,handler){if(!this._eventHandlers[event]){this._eventHandlers[event]=[];var self=this;this["on"+event]=function(eventObject){self.dispatchEvent(eventObject)}}this._eventHandlers[event].push(handler)},removeEventListener:function removeEventListener(event,handler){if(!this._eventHandlers[event]){return}var handlers=this._eventHandlers[event];handlers.splice(handlers.indexOf(handler),1);if(!handlers.length){delete this._eventHandlers[event];delete this["on"+event]}},dispatchEvent:function dispatchEvent(event){var handlers=this._eventHandlers[event.type];if(!handlers){return}for(var i=0;i<handlers.length;i++){handlers[i].call(this,event)}},send:function send(data){(0,_helpersDelay2["default"])(function(){this.service.sendMessageToServer((0,_helpersMessageEvent2["default"])("message",data,this.url))},this)},close:function close(){(0,_helpersDelay2["default"])(function(){this.service.closeConnectionFromClient((0,_helpersMessageEvent2["default"])("close",null,this.url),this)},this)},_updateReadyState:function _updateReadyState(newReadyState){if(newReadyState>=0&&newReadyState<=4){this.readyState=newReadyState}}};exports["default"]=MockSocket;module.exports=exports["default"]},{"./helpers/delay":1,"./helpers/global-context":2,"./helpers/message-event":3,"./helpers/url-transform":4,"./helpers/websocket-properties":5}],9:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}var _helpersMessageEvent=require("./helpers/message-event");var _helpersMessageEvent2=_interopRequireDefault(_helpersMessageEvent);var _helpersGlobalContext=require("./helpers/global-context");var _helpersGlobalContext2=_interopRequireDefault(_helpersGlobalContext);function SocketService(){this.list={}}SocketService.prototype={server:null,clientIsConnecting:function clientIsConnecting(client,readyStateFunction){this.observe("updateReadyState",readyStateFunction,client);if(!this.server){this.notifyOnlyFor(client,"updateReadyState",_helpersGlobalContext2["default"].MockSocket.CLOSED);this.notifyOnlyFor(client,"clientOnError",(0,_helpersMessageEvent2["default"])("error",null,client.url));return false}this.notifyOnlyFor(client,"updateReadyState",_helpersGlobalContext2["default"].MockSocket.OPEN);this.notify("clientHasJoined",this.server);this.notifyOnlyFor(client,"clientOnOpen",(0,_helpersMessageEvent2["default"])("open",null,this.server.url))},closeConnectionFromServer:function closeConnectionFromServer(messageEvent){this.notify("updateReadyState",_helpersGlobalContext2["default"].MockSocket.CLOSING);this.notify("clientOnclose",messageEvent);this.notify("updateReadyState",_helpersGlobalContext2["default"].MockSocket.CLOSED);this.notify("clientHasLeft")},closeConnectionFromClient:function closeConnectionFromClient(messageEvent,client){if(client.readyState===_helpersGlobalContext2["default"].MockSocket.OPEN){this.notifyOnlyFor(client,"updateReadyState",_helpersGlobalContext2["default"].MockSocket.CLOSING);this.notifyOnlyFor(client,"clientOnclose",messageEvent);this.notifyOnlyFor(client,"updateReadyState",_helpersGlobalContext2["default"].MockSocket.CLOSED);this.notify("clientHasLeft")}},sendMessageToServer:function sendMessageToServer(messageEvent){this.notify("clientHasSentMessage",messageEvent.data,messageEvent)},sendMessageToClients:function sendMessageToClients(messageEvent){this.notify("clientOnMessage",messageEvent)},setCallbackObserver:function setCallbackObserver(observerKey,callback,server){this.observe(observerKey,callback,server)},observe:function observe(namespace,callback,context){if(typeof namespace!=="string"||typeof callback!=="function"||context&&typeof context!=="object"){return false}if(!this.list[namespace]){this.list[namespace]=[]}this.list[namespace].push({callback:callback,context:context})},clearAll:function clearAll(namespace){if(!this.verifyNamespaceArg(namespace)){return false}this.list[namespace]=[]},notify:function notify(namespace){var argumentsForCallback=Array.prototype.slice.call(arguments,1);if(!this.verifyNamespaceArg(namespace)){return false}for(var i=0,len=this.list[namespace].length;i<len;i++){this.list[namespace][i].callback.apply(this.list[namespace][i].context,argumentsForCallback)}},notifyOnlyFor:function notifyOnlyFor(context,namespace){var argumentsForCallback=Array.prototype.slice.call(arguments,2);if(!this.verifyNamespaceArg(namespace)){return false}for(var i=0,len=this.list[namespace].length;i<len;i++){if(this.list[namespace][i].context===context){this.list[namespace][i].callback.apply(this.list[namespace][i].context,argumentsForCallback)}}},verifyNamespaceArg:function verifyNamespaceArg(namespace){if(typeof namespace!=="string"||!this.list[namespace]){return false}return true}};exports["default"]=SocketService;module.exports=exports["default"]},{"./helpers/global-context":2,"./helpers/message-event":3}]},{},[6]);