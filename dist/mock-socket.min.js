!function e(t,n,s){function r(o,l){if(!n[o]){if(!t[o]){var c="function"==typeof require&&require;if(!l&&c)return c(o,!0);if(i)return i(o,!0);var a=new Error("Cannot find module '"+o+"'");throw a.code="MODULE_NOT_FOUND",a}var u=n[o]={exports:{}};t[o][0].call(u.exports,function(e){var n=t[o][1][e];return r(n?n:e)},u,u.exports,e,t,n,s)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<s.length;o++)r(s[o]);return r}({1:[function(e,t,n){var s=e("./service"),r=e("./mock-server"),i=e("./mock-socket"),o=e("./helpers/global-context");o.SocketService=s,o.MockSocket=i,o.MockServer=r},{"./helpers/global-context":4,"./mock-server":8,"./mock-socket":9,"./service":10}],2:[function(e,t,n){function s(e,t){this.send=function(n){i(function(){e.onmessage&&e.onmessage(r("message",n,t.url))},this)},this.on=function(e,n){t.on.call(t,e,n)},this.close=function(){e.close.call(e)}}var r=e("./helpers/message-event"),i=e("./helpers/delay");t.exports=s},{"./helpers/delay":3,"./helpers/message-event":5}],3:[function(e,t,n){function s(e,t){r.setTimeout(function(t){e.call(t)},4,t)}var r=e("./global-context");t.exports=s},{"./global-context":4}],4:[function(e,t,n){(function(e){var n;if(n="undefined"==typeof window?e:window,!n)throw new Error("Unable to set the global context to either window or global.");t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(e,t,n){function s(e,t,n){var s=null,r=null,i=!1,o=!1,l="",c=null;try{var a=new MessageEvent(e);a.initMessageEvent(e,i,o,t,n,l),Object.defineProperties(a,{target:{get:function(){return c},set:function(e){c=e}},srcElement:{get:function(){return this.target}},currentTarget:{get:function(){return this.target}}})}catch(u){var a={type:e,bubbles:i,cancelable:o,data:t,origin:n,lastEventId:l,source:r,ports:s,defaultPrevented:!1,returnValue:!0,clipboardData:void 0};Object.defineProperties(a,{target:{get:function(){return c},set:function(e){c=e}},srcElement:{get:function(){return this.target}},currentTarget:{get:function(){return this.target}}})}return a}t.exports=s},{}],6:[function(e,t,n){function s(e){var t=i("path",e),n=i("?",e);return n=n?"?"+n:"",""===t?e.split("?")[0]+"/"+n:e}function r(e){return!isNaN(parseFloat(e))&&isFinite(e)}function i(e,t){var n=t||window.location.toString();if(!e)return n;e=e.toString(),"//"===n.substring(0,2)?n="http:"+n:1===n.split("://").length&&(n="http://"+n),t=n.split("/");var s={auth:""},i=t[2].split("@");1===i.length?i=i[0].split(":"):(s.auth=i[0],i=i[1].split(":")),s.protocol=t[0],s.hostname=i[0],s.port=i[1]||("https"===s.protocol.split(":")[0].toLowerCase()?"443":"80"),s.pathname=(t.length>3?"/":"")+t.slice(3,t.length).join("/").split("?")[0].split("#")[0];var o=s.pathname;"/"===o.charAt(o.length-1)&&(o=o.substring(0,o.length-1));var l=s.hostname,c=l.split("."),a=o.split("/");if("hostname"===e)return l;if("domain"===e)return/^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$/.test(l)?l:c.slice(-2).join(".");if("sub"===e)return c.slice(0,c.length-2).join(".");if("port"===e)return s.port;if("protocol"===e)return s.protocol.split(":")[0];if("auth"===e)return s.auth;if("user"===e)return s.auth.split(":")[0];if("pass"===e)return s.auth.split(":")[1]||"";if("path"===e)return s.pathname;if("."===e.charAt(0)){if(e=e.substring(1),r(e))return e=parseInt(e,10),c[0>e?c.length+e:e-1]||""}else{if(r(e))return e=parseInt(e,10),a[0>e?a.length+e:e]||"";if("file"===e)return a.slice(-1)[0];if("filename"===e)return a.slice(-1)[0].split(".")[0];if("fileext"===e)return a.slice(-1)[0].split(".")[1]||"";if("?"===e.charAt(0)||"#"===e.charAt(0)){var u=n,h=null;if("?"===e.charAt(0)?u=(u.split("?")[1]||"").split("#")[0]:"#"===e.charAt(0)&&(u=u.split("#")[1]||""),!e.charAt(1))return u;e=e.substring(1),u=u.split("&");for(var f=0,p=u.length;p>f;f++)if(h=u[f].split("="),h[0]===e)return h[1]||"";return null}}return""}t.exports=s},{}],7:[function(e,t,n){function s(e){var t=function(t){return function(n){n.target=e,t.apply(e,arguments)}};Object.defineProperties(e,{onopen:{enumerable:!0,get:function(){return this._onopen},set:function(n){this._onopen=t(n),this.service.setCallbackObserver("clientOnOpen",this._onopen,e)}},onmessage:{enumerable:!0,get:function(){return this._onmessage},set:function(n){this._onmessage=t(n),this.service.setCallbackObserver("clientOnMessage",this._onmessage,e)}},onclose:{enumerable:!0,get:function(){return this._onclose},set:function(n){this._onclose=t(n),this.service.setCallbackObserver("clientOnclose",this._onclose,e)}},onerror:{enumerable:!0,get:function(){return this._onerror},set:function(n){this._onerror=t(n),this.service.setCallbackObserver("clientOnError",this._onerror,e)}}})}t.exports=s},{}],8:[function(e,t,n){function s(e){var t=new r;this.url=o(e),this.clients=[],c.MockSocket.services[this.url]=t,this.service=t,t.server=this}var r=e("./service"),i=e("./helpers/delay"),o=e("./helpers/url-transform"),l=e("./helpers/message-event"),c=e("./helpers/global-context");s.prototype={service:null,on:function(e,t){var n;if("function"!=typeof t||"string"!=typeof e)return!1;switch(e){case"connection":n="clientHasJoined";break;case"message":n="clientHasSentMessage";break;case"close":n="clientHasLeft"}"string"==typeof n&&(this.service.clearAll(n),this.service.setCallbackObserver(n,t,this))},send:function(e){i(function(){this.service.sendMessageToClients(l("message",e,this.url))},this)},close:function(){i(function(){this.service.closeConnectionFromServer(l("close",null,this.url))},this)}},t.exports=s},{"./helpers/delay":3,"./helpers/global-context":4,"./helpers/message-event":5,"./helpers/url-transform":6,"./service":10}],9:[function(e,t,n){function s(e){this.binaryType="blob",this.url=i(e),this.readyState=l.MockSocket.CONNECTING,this.service=l.MockSocket.services[this.url],c(this),r(function(){this.service.clientIsConnecting(this,this._updateReadyState)},this)}var r=e("./helpers/delay"),i=e("./helpers/url-transform"),o=e("./helpers/message-event"),l=e("./helpers/global-context"),c=e("./helpers/websocket-properties");s.CONNECTING=0,s.OPEN=1,s.CLOSING=2,s.LOADING=3,s.CLOSED=4,s.services={},s.prototype={_onopen:null,_onmessage:null,_onerror:null,_onclose:null,service:null,_eventHandlers:{},addEventListener:function(e,t){this._eventHandlers[e]||(this._eventHandlers[e]=[],this["on"+e]=this.dispatchEvent.bind(this)),this._eventHandlers[e].push(t)},removeEventListener:function(e,t){if(this._eventHandlers[e]){var n=this._eventHandlers[e];n.splice(n.indexOf(t),1),n.length||(delete this._eventHandlers[e],delete this["on"+e])}},dispatchEvent:function(e){var t=this._eventHandlers[e.type];if(t)for(var n=0;n<t.length;n++)t[n].call(this,e)},send:function(e){r(function(){this.service.sendMessageToServer(o("message",e,this.url))},this)},close:function(){r(function(){this.service.closeConnectionFromClient(o("close",null,this.url),this)},this)},_updateReadyState:function(e){e>=0&&4>=e&&(this.readyState=e)}},t.exports=s},{"./helpers/delay":3,"./helpers/global-context":4,"./helpers/message-event":5,"./helpers/url-transform":6,"./helpers/websocket-properties":7}],10:[function(e,t,n){function s(){this.list={}}var r=e("./helpers/message-event"),i=e("./helpers/global-context"),o=e("./client-server-binding");s.prototype={server:null,clientIsConnecting:function(e,t){if(this.observe("updateReadyState",t,e),!this.server)return this.notify(e,"updateReadyState",i.MockSocket.CLOSED),this.notifyOnlyFor(e,"clientOnError"),!1;this.notifyOnlyFor(e,"updateReadyState",i.MockSocket.OPEN);var n=new o(e,this.server);e.index=this.server.clients.length,this.server.clients.push(n),this.notify("clientHasJoined",n),this.notifyOnlyFor(e,"clientOnOpen",r("open",null,this.server.url))},closeConnectionFromServer:function(e){this.notify("updateReadyState",i.MockSocket.CLOSING),this.notify("clientOnclose",e),this.notify("updateReadyState",i.MockSocket.CLOSED),this.notify("clientHasLeft"),this.server.clients=[]},closeConnectionFromClient:function(e,t){t.readyState===i.MockSocket.OPEN&&(this.notifyOnlyFor(t,"updateReadyState",i.MockSocket.CLOSING),this.notifyOnlyFor(t,"clientOnclose",e),this.notifyOnlyFor(t,"updateReadyState",i.MockSocket.CLOSED),this.server.clients.splice(t.index,1),this.notify("clientHasLeft"))},sendMessageToServer:function(e){this.notify("clientHasSentMessage",e.data,e)},sendMessageToClients:function(e){this.notify("clientOnMessage",e)},setCallbackObserver:function(e,t,n){this.observe(e,t,n)},observe:function(e,t,n){return"string"!=typeof e||"function"!=typeof t||n&&"object"!=typeof n?!1:(this.list[e]||(this.list[e]=[]),void this.list[e].push({callback:t,context:n}))},clearAll:function(e){return this.verifyNamespaceArg(e)?void(this.list[e]=[]):!1},notify:function(e){var t=Array.prototype.slice.call(arguments,1);if(!this.verifyNamespaceArg(e))return!1;for(var n=0,s=this.list[e].length;s>n;n++)this.list[e][n].callback.apply(this.list[e][n].context,t)},notifyOnlyFor:function(e,t){var n=Array.prototype.slice.call(arguments,2);if(!this.verifyNamespaceArg(t))return!1;for(var s=0,r=this.list[t].length;r>s;s++)this.list[t][s].context===e&&this.list[t][s].callback.apply(this.list[t][s].context,n)},verifyNamespaceArg:function(e){return"string"==typeof e&&this.list[e]?!0:!1}},t.exports=s},{"./client-server-binding":2,"./helpers/global-context":4,"./helpers/message-event":5}]},{},[1]);